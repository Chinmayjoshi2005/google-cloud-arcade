## Configure Secure CORS for Cloud Storage

Expertly crafted by Easy Game

### Creator Chinu Bhai
- **Use the code to complete the lab quickly without any issue and manual hard work.**


### Run the following Commands in CloudShell

```bash
export BUCKET_NAME=$(gcloud storage buckets list --format="value(name)")
export BACKEND_BUCKET=static-backend-bucket
export URL_MAP=cdn-map
export PROXY=cdn-http-proxy
export FORWARDING_RULE=cdn-http-rule

gsutil iam ch allUsers:objectViewer gs://$BUCKET_NAME

gcloud compute backend-buckets create $BACKEND_BUCKET --gcs-bucket-name=$BUCKET_NAME --enable-cdn --quiet || true
gcloud compute url-maps create $URL_MAP --default-backend-bucket=$BACKEND_BUCKET --quiet || true
gcloud compute target-http-proxies create $PROXY --url-map=$URL_MAP --quiet || true
gcloud compute forwarding-rules create $FORWARDING_RULE --global --target-http-proxy=$PROXY --ports=80 --quiet || true

export IP_ADDRESS=$(gcloud compute forwarding-rules describe $FORWARDING_RULE --global --format="value(IPAddress)")
export FILE_PATH=$(gsutil ls gs://$BUCKET_NAME/** | grep -v "/$" | head -n 1 | sed "s|gs://$BUCKET_NAME/||")

echo "Waiting for Load Balancer to propagate (2-5 mins)..."
until [ $(curl -s -o /dev/null -w "%{http_code}" http://$IP_ADDRESS/$FILE_PATH) -eq 200 ]; do
  echo -n "."
  sleep 5
done

echo "Success! Finalizing cache..."
for i in {1..5}; do curl -I -s http://$IP_ADDRESS/$FILE_PATH; done
```

### Congratulations !!!!

Congrulations Your Lab is completed Successfully.

[![YouTube](https://img.shields.io/badge/Subscribe-FF0000?style=for-the-badge&logo=youtube&logoColor=white)](https://www.youtube.com/@ChinuAi-999?sub_confirmation=1)  
